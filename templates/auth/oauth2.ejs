#
# Default OAuth2Proxy configuration template.
# TODO: document
# 
# Start with some global options.
http_address = "<%- auth.bind.address %>:<%- auth.bind.port %>"
proxy_prefix = "/<%- auth.prefix %>"
upstreams = ["http://<%- gateway.host %>:<%- gateway.port %>/"]


# Pass all user details to the upstream (the gateway backend).
pass_access_token = true
pass_basic_auth = true
pass_host_header = true
pass_user_headers = true


# Configure session cookie.
cookie_domain = "<%- gateway.domain %>"
cookie_expire = "<%- auth.session.ttl %>"
cookie_httponly = true
cookie_name = "<%- auth.session.name %>"
cookie_refresh = "<%- auth.session.refresh %>"
cookie_secret = "<%- auth.session.secret %>"
cookie_secure = true


# OAuth configuration.
redirect_url = "https://<%- gateway.domain %>:<%- proxy.port %>/<%- auth.prefix %>/callback"
client_id = "<%- auth.oauth.client %>"
client_secret = "<%- auth.oauth.secret %>"
provider = "<%- auth.oauth.provider %>"


# Allow by email
<% if (!auth.extra.emails) { %>#<% } %>authenticated_emails_file = "<%- auth.extra.emails %>"
